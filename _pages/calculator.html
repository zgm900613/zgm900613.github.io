---
layout: default
title: Online Calculator
permalink: /calculator/
render_with_liquid: false
---


<h1>Online Calculator (Python in browser)</h1>

<p>在下面输入参数，点击“计算”。后台用 Python 运行计算并生成图片（全部在浏览器中完成）。</p>

<label for="input-a">参数 a1：</label>
<input id="input-a" type="number" value="2" step="0.1">
<br>

<label for="input-b">参数 b1：</label>
<input id="input-b" type="number" value="3" step="0.1">
<br><br>

<button onclick="run_calc()">计算</button>

<p id="result" style="margin-top: 1em;"></p>
<img id="plot" style="max-width:400px; display:block; margin-top:10px;">

<hr>

<p style="font-size:0.9em;color:#666;">
说明：计算和作图使用 Pyodide（Python→WebAssembly），在浏览器本地执行，不需要在电脑上安装 Python。
</p>

<!-- 加载 Pyodide -->
<script src="https://cdn.jsdelivr.net/pyodide/v0.26.2/full/pyodide.js"></script>

<script>
let pyodideReady = null;

// 第一次加载 Pyodide
async function load_pyodide_once() {
    if (pyodideReady === null) {
        pyodideReady = await loadPyodide({
            indexURL: "https://cdn.jsdelivr.net/pyodide/v0.26.2/full/"
        });
    }
    return pyodideReady;
}

async function run_calc() {

    // 1. 读取输入
    let a = parseFloat(document.getElementById("input-a").value);
    let b = parseFloat(document.getElementById("input-b").value);

    let resultP = document.getElementById("result");
    resultP.textContent = "正在加载 Python 并计算…";

    // 2. 加载 Pyodide
    let pyodide = await load_pyodide_once();

    // 3. 把 JS 的值传到 Python
    pyodide.globals.set("a", a);
    pyodide.globals.set("b", b);

    // 4. 执行 Python：直接返回 a+b
    await pyodide.runPythonAsync(`
result = a + b
    `);

    // 5. 拿到 Python 计算的结果
    let result = pyodide.globals.get("result");

    // 6. 显示结果
    resultP.textContent = "a + b = " + result;
}
</script>



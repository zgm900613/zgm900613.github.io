---
layout: default
title: Online Calculator
permalink: /calculator/
---

<h1>Online Calculator (Python in browser)</h1>

<p>在下面输入参数，点击“计算”。后台用 Python 运行计算并生成图片（全部在浏览器中完成）。</p>

<label for="input-a">参数 a1：</label>
<input id="input-a" type="number" value="2" step="0.1">
<br>

<label for="input-b">参数 b：</label>
<input id="input-b" type="number" value="3" step="0.1">
<br><br>

<button onclick="run_calc()">计算</button>

<p id="result" style="margin-top: 1em;"></p>
<img id="plot" style="max-width:400px; display:block; margin-top:10px;">

<hr>

<p style="font-size:0.9em;color:#666;">
说明：计算和作图使用 Pyodide（Python→WebAssembly），在浏览器本地执行，不需要在电脑上安装 Python。
</p>

<!-- 加载 Pyodide -->
<script src="https://cdn.jsdelivr.net/pyodide/v0.26.2/full/pyodide.js"></script>
<script>
let pyodideReadyPromise = loadPyodide({
  indexURL: "https://cdn.jsdelivr.net/pyodide/v0.26.2/full/"
});

async function run_calc() {
  const a = parseFloat(document.getElementById("input-a").value);
  const b = parseFloat(document.getElementById("input-b").value);

  const resultP = document.getElementById("result");
  const errorP = document.getElementById("error");
  const imgEl = document.getElementById("plot");  // 如果上面有 <img id="plot">

  // 清空提示
  resultP.textContent = "";
  if (errorP) errorP.textContent = "";
  if (imgEl) imgEl.src = "";

  if (isNaN(a) || isNaN(b)) {
    resultP.textContent = "";
    if (errorP) errorP.textContent = "请输入数字。";
    return;
  }

  resultP.textContent = "正在加载 Python 并计算…";

  try {
    // 等 Pyodide 加载完成
    let pyodide = await pyodideReadyPromise;

    // 把参数传给 Python
    pyodide.globals.set("a", a);
    pyodide.globals.set("b", b);

    // 这里暂时只做一个简单计算，不画图
    await pyodide.runPythonAsync(`
result = a * b
`);

    const result = pyodide.globals.get("result");
    resultP.textContent = `结果：a * b = ${result}`;
  } catch (err) {
    console.error(err);
    resultP.textContent = "";
    if (errorP) errorP.textContent = "出错了：" + err;
  }
}
</script>

